<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Asana Sync Manager - JoJo's Shave Ice</title>
    <link rel="stylesheet" href="../assets/css/styles.css">
    <style>
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #FF4040;
            text-decoration: none;
            font-weight: bold;
        }
        .back-link:hover {
            text-decoration: underline;
        }
        .asana-container {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h2 {
            color: #444;
            margin-top: 0;
        }
        .info-box {
            background-color: #f8f9fa;
            border-left: 4px solid #87CEEB;
            padding: 15px;
            margin-bottom: 20px;
        }
        .connection-status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-left: 10px;
        }
        .status-connected {
            background-color: #28a745;
            color: white;
        }
        .status-disconnected {
            background-color: #dc3545;
            color: white;
        }
        .btn {
            display: inline-block;
            background-color: #FF4040;
            color: white;
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 4px;
            font-weight: bold;
            transition: background-color 0.3s ease;
            border: none;
            cursor: pointer;
        }
        .btn:hover {
            background-color: #d93333;
        }
        .btn-secondary {
            background-color: #6c757d;
        }
        .btn-secondary:hover {
            background-color: #5a6268;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="text"],
        input[type="password"],
        select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        /* Tab Navigation */
        .tab-nav {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 20px;
        }
        .tab-btn {
            padding: 10px 20px;
            background: none;
            border: none;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            font-weight: bold;
            color: #666;
        }
        .tab-btn.active {
            border-bottom: 2px solid #FF4040;
            color: #FF4040;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        
        /* Two-column layout */
        .row {
            display: flex;
            margin: 0 -10px;
        }
        .col {
            padding: 0 10px;
            flex: 1;
        }
        
        /* Project list */
        .project-list {
            height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            margin-bottom: 15px;
        }
        .project-item {
            padding: 8px;
            border-bottom: 1px solid #eee;
        }
        .project-item:last-child {
            border-bottom: none;
        }
        .project-checkbox {
            margin-right: 8px;
        }
        .project-stats {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
        }
        
        /* History log */
        .history-log {
            height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            background-color: #f9f9f9;
        }
        .log-entry {
            padding: 8px;
            border-bottom: 1px solid #eee;
            font-size: 0.9rem;
        }
        .log-entry:last-child {
            border-bottom: none;
        }
        .log-time {
            color: #888;
            font-size: 0.8rem;
        }
        .log-message {
            margin-top: 3px;
        }
        .log-success {
            color: #28a745;
        }
        .log-error {
            color: #dc3545;
        }
        .log-warning {
            color: #ffc107;
        }
        
        /* Task viewer */
        .task-filters {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 15px;
        }
        .task-list {
            margin-top: 20px;
        }
        .task-item {
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 10px;
            background-color: #f9f9f9;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .task-item:hover {
            background-color: #f0f0f0;
        }
        .task-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .task-details {
            color: #666;
            font-size: 0.9rem;
        }
        
        /* Task modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            overflow: auto;
        }
        .modal-content {
            background-color: white;
            margin: 40px auto;
            padding: 20px;
            width: 80%;
            max-width: 800px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .modal-title {
            font-size: 1.4rem;
            font-weight: bold;
        }
        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }
        .modal-body {
            max-height: 70vh;
            overflow-y: auto;
        }
        .task-property {
            margin-bottom: 15px;
        }
        .property-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .load-more {
            text-align: center;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <header>
        <h1>JoJo's Shave Ice Management Hub</h1>
    </header>
    
    <div class="container">
        <a href="/" class="back-link">‚Üê Back to Dashboard</a>
        
        <div class="asana-container">
            <h2>Asana Sync Manager <span class="connection-status status-disconnected">Disconnected</span></h2>
            
            <div id="connection-notice" class="info-box">
                <p>This tool allows you to synchronize tasks between Asana and JoJo's Shave Ice internal systems. Connect your Asana account to get started.</p>
            </div>
            
            <!-- Always show tab navigation -->
            <div class="tab-nav">
                <button class="tab-btn" data-tab="workspace-sync">Workspace Sync</button>
                <button class="tab-btn" data-tab="task-viewer">Task Viewer</button>
                <button class="tab-btn active" data-tab="settings">Settings</button>
            </div>
            
            <!-- Workspace Sync Tab -->
            <div id="workspace-sync" class="tab-content">
                <div id="not-connected-workspace" class="info-box" style="background-color: #fff3cd; border-left-color: #ffc107;">
                    <p>You need to configure your Asana connection first. Go to the Settings tab to enter your Asana Personal Access Token.</p>
                </div>
                
                <div id="connected-workspace" style="display: none;">
                    <div class="form-group">
                        <label for="workspace-select">Select Workspace</label>
                        <select id="workspace-select">
                            <option value="">-- Select a workspace --</option>
                            <option value="workspace1">JoJo's Shave Ice</option>
                            <option value="workspace2">Operations Team</option>
                            <option value="workspace3">Marketing Team</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <button id="force-sync-btn" class="btn">Force Sync Now</button>
                        <span id="last-sync-time" style="margin-left: 15px; font-size: 0.9rem; color: #666;">Last sync: Never</span>
                    </div>
                    
                    <div class="row">
                        <div class="col">
                            <h3>Projects</h3>
                            <div class="form-group">
                                <label class="project-select-all">
                                    <input type="checkbox" id="select-all-projects"> Select all projects
                                </label>
                            </div>
                            <div class="project-list" id="project-list">
                                <div class="project-item">
                                    <label>
                                        <input type="checkbox" class="project-checkbox" value="project1">
                                        JoJo's Operations
                                    </label>
                                    <div class="project-stats">
                                        Tasks synced: 24 | Failed: 0 | Last sync: May 1, 2024
                                    </div>
                                </div>
                                <div class="project-item">
                                    <label>
                                        <input type="checkbox" class="project-checkbox" value="project2">
                                        Store Maintenance
                                    </label>
                                    <div class="project-stats">
                                        Tasks synced: 12 | Failed: 1 | Last sync: May 1, 2024
                                    </div>
                                </div>
                                <div class="project-item">
                                    <label>
                                        <input type="checkbox" class="project-checkbox" value="project3">
                                        Inventory Management
                                    </label>
                                    <div class="project-stats">
                                        Tasks synced: 31 | Failed: 0 | Last sync: May 1, 2024
                                    </div>
                                </div>
                                <div class="project-item">
                                    <label>
                                        <input type="checkbox" class="project-checkbox" value="project4">
                                        Marketing Campaigns
                                    </label>
                                    <div class="project-stats">
                                        Tasks synced: 18 | Failed: 2 | Last sync: April 30, 2024
                                    </div>
                                </div>
                                <div class="project-item">
                                    <label>
                                        <input type="checkbox" class="project-checkbox" value="project5">
                                        Product Development
                                    </label>
                                    <div class="project-stats">
                                        Tasks synced: 7 | Failed: 0 | Last sync: April 29, 2024
                                    </div>
                                </div>
                                <div class="project-item">
                                    <label>
                                        <input type="checkbox" class="project-checkbox" value="project6">
                                        Customer Feedback
                                    </label>
                                    <div class="project-stats">
                                        Tasks synced: 14 | Failed: 1 | Last sync: April 28, 2024
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col">
                            <h3>Sync History</h3>
                            <div class="history-log" id="history-log">
                                <div class="log-entry">
                                    <div class="log-time">May 1, 2024 - 14:32:15</div>
                                    <div class="log-message log-success">Successfully synced 15 tasks from JoJo's Operations</div>
                                </div>
                                <div class="log-entry">
                                    <div class="log-time">May 1, 2024 - 14:32:10</div>
                                    <div class="log-message log-error">Failed to sync 1 task from Store Maintenance: Task ID 12345 not found</div>
                                </div>
                                <div class="log-entry">
                                    <div class="log-time">May 1, 2024 - 14:32:05</div>
                                    <div class="log-message log-success">Successfully synced 12 tasks from Store Maintenance</div>
                                </div>
                                <div class="log-entry">
                                    <div class="log-time">May 1, 2024 - 14:31:58</div>
                                    <div class="log-message log-success">Successfully synced 31 tasks from Inventory Management</div>
                                </div>
                                <div class="log-entry">
                                    <div class="log-time">April 30, 2024 - 09:15:40</div>
                                    <div class="log-message log-warning">Partial sync completed for Marketing Campaigns: 18 tasks synced, 2 failed</div>
                                </div>
                                <div class="log-entry">
                                    <div class="log-time">April 29, 2024 - 11:30:22</div>
                                    <div class="log-message log-success">Successfully synced 7 tasks from Product Development</div>
                                </div>
                                <div class="log-entry">
                                    <div class="log-time">April 28, 2024 - 15:45:10</div>
                                    <div class="log-message log-warning">Partial sync completed for Customer Feedback: 14 tasks synced, 1 failed</div>
                                </div>
                            </div>
                            <div class="load-more">
                                <button id="load-more-logs" class="btn btn-secondary">Load More</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Task Viewer Tab -->
            <div id="task-viewer" class="tab-content">
                <div id="not-connected-tasks" class="info-box" style="background-color: #fff3cd; border-left-color: #ffc107;">
                    <p>You need to configure your Asana connection first. Go to the Settings tab to enter your Asana Personal Access Token.</p>
                </div>
                
                <div id="connected-tasks" style="display: none;">
                    <div class="task-filters">
                        <div class="row">
                            <div class="col">
                                <div class="form-group">
                                    <label for="filter-project">Project</label>
                                    <select id="filter-project">
                                        <option value="">All Projects</option>
                                        <option value="project1">JoJo's Operations</option>
                                        <option value="project2">Store Maintenance</option>
                                        <option value="project3">Inventory Management</option>
                                        <option value="project4">Marketing Campaigns</option>
                                        <option value="project5">Product Development</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col">
                                <div class="form-group">
                                    <label for="filter-status">Status</label>
                                    <select id="filter-status">
                                        <option value="">All Statuses</option>
                                        <option value="not_started">Not Started</option>
                                        <option value="in_progress">In Progress</option>
                                        <option value="completed">Completed</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col">
                                <div class="form-group">
                                    <label for="filter-assignee">Assignee</label>
                                    <select id="filter-assignee">
                                        <option value="">All Assignees</option>
                                        <option value="user1">John Smith</option>
                                        <option value="user2">Jane Doe</option>
                                        <option value="user3">Mike Johnson</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <button id="apply-filters" class="btn">Apply Filters</button>
                            <button id="reset-filters" class="btn btn-secondary" style="margin-left: 10px;">Reset</button>
                        </div>
                    </div>
                    
                    <div class="task-list" id="task-list">
                        <div class="task-item" data-task-id="task1">
                            <div class="task-title">Update weekly inventory sheet</div>
                            <div class="task-details">
                                <p>Project: Inventory Management | Assigned to: Manager | Due: May 5, 2024</p>
                                <p>Status: In Progress</p>
                            </div>
                        </div>
                        <div class="task-item" data-task-id="task2">
                            <div class="task-title">Order new cups and lids</div>
                            <div class="task-details">
                                <p>Project: Inventory Management | Assigned to: Inventory Manager | Due: May 8, 2024</p>
                                <p>Status: Not Started</p>
                            </div>
                        </div>
                        <div class="task-item" data-task-id="task3">
                            <div class="task-title">Schedule staff training for new flavors</div>
                            <div class="task-details">
                                <p>Project: JoJo's Operations | Assigned to: Store Manager | Due: May 12, 2024</p>
                                <p>Status: Not Started</p>
                            </div>
                        </div>
                        <div class="task-item" data-task-id="task4">
                            <div class="task-title">Fix leaking faucet in Waimea location</div>
                            <div class="task-details">
                                <p>Project: Store Maintenance | Assigned to: Maintenance | Due: May 3, 2024</p>
                                <p>Status: In Progress</p>
                            </div>
                        </div>
                        <div class="task-item" data-task-id="task5">
                            <div class="task-title">Create summer promotion materials</div>
                            <div class="task-details">
                                <p>Project: Marketing Campaigns | Assigned to: Marketing Manager | Due: May 15, 2024</p>
                                <p>Status: Not Started</p>
                            </div>
                        </div>
                    </div>
                    <div class="load-more">
                        <button id="load-more-tasks" class="btn btn-secondary">Load More Tasks</button>
                    </div>
                </div>
            </div>
            
            <!-- Settings Tab -->
            <div id="settings" class="tab-content active">
                <div class="info-box">
                    <p>Configure your Asana integration settings here. Your Personal Access Token will be securely stored in Firestore.</p>
                </div>
                
                <form id="settings-form">
                    <div class="form-group">
                        <label for="asana-pat">Asana Personal Access Token (PAT)</label>
                        <input type="password" id="asana-pat" placeholder="Enter your Asana PAT">
                        <small style="display: block; margin-top: 5px; color: #666;">You can generate a PAT in your Asana account settings</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="sync-frequency">Sync Frequency</label>
                        <select id="sync-frequency">
                            <option value="15">Every 15 minutes</option>
                            <option value="30">Every 30 minutes</option>
                            <option value="60" selected>Every hour</option>
                            <option value="360">Every 6 hours</option>
                            <option value="720">Every 12 hours</option>
                            <option value="1440">Once a day</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <button type="submit" class="btn">Save Settings</button>
                        <button type="button" id="test-connection" class="btn btn-secondary" style="margin-left: 10px;">Test Connection</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Task Detail Modal -->
    <div id="task-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Task Details</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body" id="task-modal-body">
                <!-- Task details will be dynamically inserted here -->
            </div>
        </div>
    </div>
    
    <footer>
        JoJo's Shave Ice Management Hub &copy; 2024 | Version 1.0.0
    </footer>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script>
        // Initialize Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCgEDfRBjbqqnwWc0TeR97V3RvfrvjJu1U",
            authDomain: "jojo-s-app-back-end.firebaseapp.com",
            projectId: "jojo-s-app-back-end",
            storageBucket: "jojo-s-app-back-end.appspot.com",
            messagingSenderId: "344579778389",
            appId: "1:344579778389:web:6a17be1a1d13b82955f1dc",
            measurementId: "G-VBP44WBTCP"
        };
        
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        
        document.addEventListener('DOMContentLoaded', function() {
            // Check if connection is established from Firestore
            checkConnectionStatus();
            
            // Tab navigation
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.getAttribute('data-tab');
                    
                    // Update active tab button
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    
                    // Show active tab content
                    tabContents.forEach(content => content.classList.remove('active'));
                    document.getElementById(tabId).classList.add('active');
                });
            });
            
            // Select all projects checkbox
            const selectAllCheckbox = document.getElementById('select-all-projects');
            const projectCheckboxes = document.querySelectorAll('.project-checkbox');
            
            selectAllCheckbox.addEventListener('change', function() {
                projectCheckboxes.forEach(checkbox => {
                    checkbox.checked = selectAllCheckbox.checked;
                });
            });
            
            // Force sync button
            const forceSyncBtn = document.getElementById('force-sync-btn');
            forceSyncBtn.addEventListener('click', function() {
                const selectedProjects = Array.from(document.querySelectorAll('.project-checkbox:checked'))
                    .map(checkbox => checkbox.value);
                
                if (selectedProjects.length === 0) {
                    alert('Please select at least one project to sync');
                    return;
                }
                
                alert(`Starting sync for ${selectedProjects.length} projects...`);
                // Here you would trigger the actual sync process with the Asana API
                
                // Update last sync time (for demo purposes)
                const now = new Date();
                const formattedDate = now.toLocaleString();
                document.getElementById('last-sync-time').textContent = `Last sync: ${formattedDate}`;
                
                // Add a new log entry (for demo purposes)
                const logEntry = document.createElement('div');
                logEntry.className = 'log-entry';
                logEntry.innerHTML = `
                    <div class="log-time">${formattedDate}</div>
                    <div class="log-message log-success">Started manual sync for ${selectedProjects.length} projects</div>
                `;
                const historyLog = document.getElementById('history-log');
                historyLog.insertBefore(logEntry, historyLog.firstChild);
            });
            
            // Load more logs button
            document.getElementById('load-more-logs').addEventListener('click', function() {
                alert('Loading more log entries...');
                // Here you would fetch more log entries from Firestore
            });
            
            // Apply filters button
            document.getElementById('apply-filters').addEventListener('click', function() {
                const project = document.getElementById('filter-project').value;
                const status = document.getElementById('filter-status').value;
                const assignee = document.getElementById('filter-assignee').value;
                
                alert(`Filtering tasks by - Project: ${project || 'All'}, Status: ${status || 'All'}, Assignee: ${assignee || 'All'}`);
                // Here you would filter tasks based on the selected criteria
            });
            
            // Reset filters button
            document.getElementById('reset-filters').addEventListener('click', function() {
                document.getElementById('filter-project').value = '';
                document.getElementById('filter-status').value = '';
                document.getElementById('filter-assignee').value = '';
            });
            
            // Load more tasks button
            document.getElementById('load-more-tasks').addEventListener('click', function() {
                alert('Loading more tasks...');
                // Here you would fetch more tasks from Firestore
            });
            
            // Settings form submission
            document.getElementById('settings-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const pat = document.getElementById('asana-pat').value;
                const syncFrequency = document.getElementById('sync-frequency').value;
                
                if (!pat) {
                    alert('Please enter your Asana Personal Access Token');
                    return;
                }
                
                // Save settings to Firestore
                db.collection('asanaSettings').doc('config').set({
                    pat: pat,
                    syncFrequency: parseInt(syncFrequency),
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp(),
                    lastSync: null,
                    active: true
                }, { merge: true })
                .then(() => {
                    console.log('Settings saved successfully!');
                    alert('Settings saved successfully!');
                    updateConnectionStatus(true);
                })
                .catch((error) => {
                    console.error('Error saving settings:', error);
                    alert(`Error saving settings: ${error.message}. Please try again.`);
                });
            });
            
            // Test connection button
            document.getElementById('test-connection').addEventListener('click', function() {
                const pat = document.getElementById('asana-pat').value;
                
                if (!pat) {
                    alert('Please enter your Asana Personal Access Token');
                    return;
                }
                
                alert('Testing connection to Asana...');
                console.log("Testing connection with PAT: " + pat.substring(0, 4) + "...");
                
                // For demo purposes, simulate a successful connection
                setTimeout(() => {
                    // Test connection success
                    db.collection('asanaSettings').doc('connection_test').set({
                        timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                        status: 'success',
                        message: 'Connection test successful'
                    })
                    .then(() => {
                        console.log('Connection test logged successfully');
                        alert('Connection successful!');
                        updateConnectionStatus(true);
                    })
                    .catch((error) => {
                        console.error('Error logging connection test:', error);
                        alert(`Error during connection test: ${error.message}. Please try again.`);
                    });
                }, 1000);
            });
            
            // Open task detail modal when clicking on a task
            const taskItems = document.querySelectorAll('.task-item');
            const taskModal = document.getElementById('task-modal');
            const closeBtn = document.querySelector('.close-btn');
            
            taskItems.forEach(task => {
                task.addEventListener('click', function() {
                    const taskId = this.getAttribute('data-task-id');
                    openTaskModal(taskId);
                });
            });
            
            closeBtn.addEventListener('click', function() {
                taskModal.style.display = 'none';
            });
            
            window.addEventListener('click', function(e) {
                if (e.target === taskModal) {
                    taskModal.style.display = 'none';
                }
            });
        });
        
        // Check connection status from Firestore
        function checkConnectionStatus() {
            db.collection('asanaSettings').doc('config').get()
                .then((doc) => {
                    if (doc.exists && doc.data().pat) {
                        updateConnectionStatus(true);
                    } else {
                        updateConnectionStatus(false);
                    }
                })
                .catch((error) => {
                    console.error('Error checking connection status:', error);
                    updateConnectionStatus(false);
                });
        }
        
        // Update UI based on connection status
        function updateConnectionStatus(isConnected) {
            const connectionStatus = document.querySelector('.connection-status');
            
            if (isConnected) {
                connectionStatus.className = 'connection-status status-connected';
                connectionStatus.textContent = 'Connected';
                
                // Show connected content
                document.getElementById('connected-workspace').style.display = 'block';
                document.getElementById('not-connected-workspace').style.display = 'none';
                
                document.getElementById('connected-tasks').style.display = 'block';
                document.getElementById('not-connected-tasks').style.display = 'none';
            } else {
                connectionStatus.className = 'connection-status status-disconnected';
                connectionStatus.textContent = 'Disconnected';
                
                // Show disconnected content
                document.getElementById('connected-workspace').style.display = 'none';
                document.getElementById('not-connected-workspace').style.display = 'block';
                
                document.getElementById('connected-tasks').style.display = 'none';
                document.getElementById('not-connected-tasks').style.display = 'block';
            }
        }
        
        // Open task detail modal
        function openTaskModal(taskId) {
            const taskModal = document.getElementById('task-modal');
            const taskModalBody = document.getElementById('task-modal-body');
            
            // For demo purposes, set some static data based on task ID
            let taskData;
            
            switch (taskId) {
                case 'task1':
                    taskData = {
                        title: 'Update weekly inventory sheet',
                        description: 'Compile a comprehensive inventory report for all three locations. Make sure to include current stock levels, items that need reordering, and notes about any discrepancies.',
                        assignee: 'Manager',
                        dueDate: 'May 5, 2024',
                        status: 'In Progress',
                        project: 'Inventory Management',
                        createdAt: 'April 28, 2024',
                        priority: 'High',
                        sections: ['Weekly Tasks', 'Admin'],
                        tags: ['Inventory', 'Reporting', 'Weekly']
                    };
                    break;
                case 'task2':
                    taskData = {
                        title: 'Order new cups and lids',
                        description: 'Place an order for 5,000 small cups, 3,000 medium cups, and 2,000 large cups with matching lids. Use the approved supplier and check for any available discounts.',
                        assignee: 'Inventory Manager',
                        dueDate: 'May 8, 2024',
                        status: 'Not Started',
                        project: 'Inventory Management',
                        createdAt: 'April 30, 2024',
                        priority: 'Medium',
                        sections: ['Supplies', 'Ordering'],
                        tags: ['Inventory', 'Supplies', 'Ordering']
                    };
                    break;
                default:
                    taskData = {
                        title: 'Task details not found',
                        description: 'No additional information available for this task.',
                        assignee: 'Unknown',
                        dueDate: 'Unknown',
                        status: 'Unknown',
                        project: 'Unknown',
                        createdAt: 'Unknown',
                        priority: 'Unknown',
                        sections: [],
                        tags: []
                    };
            }
            
            // Generate HTML for task details
            let taskDetailsHTML = `
                <div class="task-property">
                    <div class="property-name">Title</div>
                    <div>${taskData.title}</div>
                </div>
                <div class="task-property">
                    <div class="property-name">Description</div>
                    <div>${taskData.description}</div>
                </div>
                <div class="task-property">
                    <div class="property-name">Project</div>
                    <div>${taskData.project}</div>
                </div>
                <div class="task-property">
                    <div class="property-name">Assignee</div>
                    <div>${taskData.assignee}</div>
                </div>
                <div class="task-property">
                    <div class="property-name">Due Date</div>
                    <div>${taskData.dueDate}</div>
                </div>
                <div class="task-property">
                    <div class="property-name">Status</div>
                    <div>${taskData.status}</div>
                </div>
                <div class="task-property">
                    <div class="property-name">Priority</div>
                    <div>${taskData.priority}</div>
                </div>
                <div class="task-property">
                    <div class="property-name">Created</div>
                    <div>${taskData.createdAt}</div>
                </div>
            `;
            
            if (taskData.sections && taskData.sections.length > 0) {
                taskDetailsHTML += `
                    <div class="task-property">
                        <div class="property-name">Sections</div>
                        <div>${taskData.sections.join(', ')}</div>
                    </div>
                `;
            }
            
            if (taskData.tags && taskData.tags.length > 0) {
                taskDetailsHTML += `
                    <div class="task-property">
                        <div class="property-name">Tags</div>
                        <div>${taskData.tags.join(', ')}</div>
                    </div>
                `;
            }
            
            // Set modal title and content
            document.querySelector('.modal-title').textContent = taskData.title;
            taskModalBody.innerHTML = taskDetailsHTML;
            
            // Show the modal
            taskModal.style.display = 'block';
        }
    </script>
</body>
</html> 